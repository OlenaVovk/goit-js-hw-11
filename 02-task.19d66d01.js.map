{"mappings":"mjBAOA,IAEIA,EACAC,EAHAC,EAAO,EACPC,EAAc,GAIlB,MAAMC,EAAOC,SAASC,cAAc,QAC9BC,EAAQF,SAASC,cAAc,YAC/BE,EAAYH,SAASC,cAAc,YACnCG,EAAWJ,SAASC,cAAc,aAOlCI,EAAW,IAAIC,sBA2BrB,SAAiBC,EAASC,GACxBD,EAAQE,SAAQC,IACVA,EAAMC,iBACRd,GAAO,EACPe,EAAUd,G,MApCA,CACde,KAAM,KACNC,WAAY,QACZC,UAAW,IAwCbC,eAAeJ,EAAWK,GACxB,IACE,MAAMC,QAAaC,EAAAC,SAAaH,EAAKpB,GAGrC,GAFAF,EAAM0B,KAAKC,KAAKJ,EAAKK,UAzDR,KA2DRL,EAAKM,KAAKC,OAIb,OAHAC,EAAAC,GAASC,OAAOC,QAAQ,4EACxB3B,EAAM4B,UAAY,QAClB3B,EAAU4B,UAAUC,IAAI,mBAIb,IAATnC,GACF6B,EAAAC,GAASC,OAAOK,QAAQ,oBAAoBf,EAAKK,qBACjDrB,EAAM4B,UAAY,GAClBI,EAAUhB,EAAKM,KAAMtB,GACrBG,EAAS8B,QAAQ/B,GACjBD,EAAU4B,UAAUC,IAAI,oBAExBE,EAAUhB,EAAKM,KAAMtB,GAGnBL,IAASF,IACXQ,EAAU4B,UAAUK,OAAO,mBAC3B/B,EAASgC,UAAUjC,G,CAIvB,MAAOkC,GACLC,QAAQC,IAAK,iBAA4BF,EAAMG,SAC/Cf,EAAAC,GAASC,OAAOC,QAAQ,+C,EAI5B,SAASK,EAAUhB,EAAMwB,GACvBA,EAAKC,mBAAmB,YAQ1B,SAAoBzB,GAClB,OAAQA,EAAK0B,KAAI,EAACC,aAACA,EAAYC,cAAEA,EAAaC,KAAEA,EAAIC,MAAEA,EAAKC,MAAEA,EAAKC,SAAEA,EAAQC,UAAEA,KAC9E,gEACmCL,4BAAwCD,mBAA8BC,WAAuBC,sHAElEC,+EACAC,kFACGC,mFACCC,6CAEvDC,KAAK,G,CAlBqBC,CAAWnC,IAChDtB,EAAU,IAAI0D,eAAe,cACzBzD,EAAO,GACTD,EAAQ2D,S,CA1EZxD,EAAKyD,iBAAiB,UAGtB,SAAmBC,GAIjB,GAHAA,EAAIC,iBACJ7D,EAAO,EACPC,EAAc2D,EAAIE,cAAcC,SAASC,YAAYC,OAChDhE,EAI2B,OAH9BI,EAAM4B,UAAY,GAClB3B,EAAU4B,UAAUC,IAAI,wBACxBN,EAAAC,GAASC,OAAOC,QAAQ,wCAG1BjB,EAAUd,GACV2D,EAAIE,cAAcI,O,IAbpB/D,SAASwD,iBAAiB,UAgB1B,WACE,MAAQQ,OAAQC,GAAejE,SAASC,cAAc,YAAYiE,kBAAkBC,wBACpFC,OAAOC,SAAS,CACdC,IAAgB,EAAXL,EACLM,SAAU,U","sources":["src/js/02-task.js"],"sourcesContent":["//import baguetteBox from 'baguettebox.js';\n\nimport '../css/styles.css';\nimport Notiflix from 'notiflix';\nimport * as API from './fetchAPI';\n\nconst PAGE_SET = 40;\nlet page = 1;\nlet searchQuery = '';\nlet max;\nlet gallery;  \n\nconst form = document.querySelector('form');\nconst divEl = document.querySelector('.gallery');\nconst messageEl = document.querySelector('.message');\nconst targetEl = document.querySelector('.js-guard');\n\nconst options = {\n  root: null,\n  rootMargin: '600px',\n  threshold: 1.0,\n}\nconst observer = new IntersectionObserver(onLoad, options);\n\nform.addEventListener('submit', onSubmit);\ndocument.addEventListener('scroll', updateImg);\n\nfunction onSubmit (evt) {\n  evt.preventDefault();\n  page = 1;\n  searchQuery = evt.currentTarget.elements.searchQuery.value\n  if (!searchQuery) {\n    divEl.innerHTML = '';\n    messageEl.classList.add('visually-hidden');\n    Notiflix.Notify.failure('Введіть будь ласка текст для пошуку!'); \n    return;\n  }\n  fetchData(searchQuery);\n  evt.currentTarget.reset();\n}\n\nfunction updateImg() {\n  const { height: cardHeight } = document.querySelector(\".gallery\").firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight*2,\n    behavior: \"smooth\",\n  });\n}\n\nfunction onLoad (entries, observer){\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      page +=1;\n      fetchData(searchQuery);\n    } \n  });\n}\n\n\n\nasync function fetchData (res) {\n  try {\n    const data = await API.fetchAPI(res, page);\n    max = Math.ceil(data.totalHits/PAGE_SET);\n    \n    if (!data.hits.length) {\n      Notiflix.Notify.failure('Sorry, there are no images matching your search query. Please try again.');\n      divEl.innerHTML = '';\n      messageEl.classList.add('visually-hidden');\n      return;\n    }\n    \n    if (page === 1) {\n      Notiflix.Notify.success(`Hooray! We found ${data.totalHits} images.`); \n      divEl.innerHTML = '';\n      addImages(data.hits, divEl);\n      observer.observe(targetEl);\n      messageEl.classList.add('visually-hidden');\n    } else {\n      addImages(data.hits, divEl)\n    }\n\n    if (page === max) {\n      messageEl.classList.remove('visually-hidden');\n      observer.unobserve(targetEl);\n    }\n  } \n  \n  catch (error) {\n    console.log ('Oй помилочка: ', error.message);\n    Notiflix.Notify.failure('Упсс щось пішло не так... Спробуйте пізніше!');\n  }\n}\n\nfunction addImages(data, elem) {\n  elem.insertAdjacentHTML('beforeend', makeMarkup(data));\n  gallery = new SimpleLightbox('.gallery a');\n  if (page > 1) {\n    gallery.refresh();\n  }\n  return;\n}\n\nfunction makeMarkup(data) {\n  return  data.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => \n  `<div class=\"photo-card\">\n    <a class=\"gallery__item\" href=\"${largeImageURL}\"><img class=\"img\" src=\"${webformatURL}\" data-source=\"${largeImageURL}\" alt=\"${tags}\" loading=\"lazy\"/></a>\n        <div class=\"info\">\n          <p class=\"info-item\"><span><b>Likes</b></span><span>${likes}</span></p>\n          <p class=\"info-item\"><span><b>Views</b></span><span>${views}</span></p>\n          <p class=\"info-item\"><span><b>Comments</b></span><span>${comments}</span></p>\n          <p class=\"info-item\"><span><b>Downloads</b></span><span>${downloads}</span></p>\n        </div>\n    </div>`).join('');  \n}\n\n\n  \n"],"names":["$4a36cbd4de2d2245$var$max","$4a36cbd4de2d2245$var$gallery","$4a36cbd4de2d2245$var$page","$4a36cbd4de2d2245$var$searchQuery","$4a36cbd4de2d2245$var$form","document","querySelector","$4a36cbd4de2d2245$var$divEl","$4a36cbd4de2d2245$var$messageEl","$4a36cbd4de2d2245$var$targetEl","$4a36cbd4de2d2245$var$observer","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","$4a36cbd4de2d2245$var$fetchData","root","rootMargin","threshold","async","res","data","$cqGDw","fetchAPI","Math","ceil","totalHits","hits","length","$parcel$interopDefault","$eWCmQ","Notify","failure","innerHTML","classList","add","success","$4a36cbd4de2d2245$var$addImages","observe","remove","unobserve","error","console","log","message","elem","insertAdjacentHTML","map","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join","$4a36cbd4de2d2245$var$makeMarkup","SimpleLightbox","refresh","addEventListener","evt","preventDefault","currentTarget","elements","searchQuery","value","reset","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior"],"version":3,"file":"02-task.19d66d01.js.map"}