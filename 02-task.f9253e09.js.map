{"mappings":"iiBAEA,IAOIA,EAEAC,EACAC,EAVJC,EAAAC,EAAA,S,oDAQIC,EAAc,GAIZC,EAAOC,SAASC,cAAc,QAC9BC,EAAQF,SAASC,cAAc,YAC/BE,EAAYH,SAASC,cAAc,YACnCG,EAAWJ,SAASC,cAAc,aAOlCI,EAAW,IAAIC,sBA+BrB,SAAiBC,EAASC,GACxBD,EAAQE,SAAQ,SAAAC,GACdC,QAAQC,IAAI,uBAAwBF,EAAMG,gBAC1CF,QAAQC,IAAI,OAAQnB,GACfK,GAGDY,EAAMG,iBACRpB,GAAO,EACPqB,EAAUhB,G,MA7CA,CACdiB,KAAM,KACNC,WAAY,QACZC,UAAW,I,SAiDEH,EAAWI,G,OAAXC,EAASC,MAAAC,KAAAC,U,UAATH,I,OAAAA,EAAfI,EAAA3B,EAAA,CAAA2B,EAAAC,GAAAC,MAAA,SAAAC,EAA0BR,G,IAEhBS,E,2FAAaC,EAAAC,SAAaX,EAAKzB,G,UAA/BkC,EAAIG,EAAAC,KACVrC,EAAMsC,KAAKC,KAAKN,EAAKO,UAlER,IAoEbvB,QAAQC,IAAI,OAAOe,GACnBhB,QAAQC,IAAI,mBAAmBe,EAAKQ,KAAKC,QAEpCT,EAAKQ,KAAKC,OAAM,C,uBAEnBb,EAAAc,GAASC,OAAOC,QAAQ,4EACxBrC,EAAMsC,UAAY,GAClBrC,EAAUsC,UAAUC,IAAI,mB,2BAIb,IAATjD,GACF8B,EAAAc,GAASC,OAAOK,QAAQ,oBAAmCC,OAAfjB,EAAKO,UAAU,aAC3DhC,EAAMsC,WAAY,EAAAK,EAAAC,YAAWnB,EAAKQ,MAClCxC,EAAU,IAAIoD,eAAe,cAC7B1C,EAAS2C,QAAQ5C,GACjBD,EAAUsC,UAAUC,IAAI,qBAExBxC,EAAM+C,mBAAmB,aAAa,EAAAJ,EAAAC,YAAWnB,EAAKQ,OACtDxC,EAAQuD,WAGNzD,IAASC,IACXS,EAAUsC,UAAUU,OAAO,mBAC3B9C,EAAS+C,UAAUhD,I,kDAKrBO,QAAQC,IAAK,iBAA4BkB,EAAAuB,GAAMC,SAC/C/B,EAAAc,GAASC,OAAOC,QAAQ,gD,2DAnCJnB,MAAAC,KAAAC,U,CA7CxBvB,EAAKwD,iBAAiB,UAGtB,SAAmBC,GAKjB,GAJAA,EAAIC,iBACJ3D,EAAc0D,EAAIE,cAAcC,SAASC,YAAYC,MACrDlD,QAAQC,IAAI,cAAcd,GAC1BL,EAAO,GACFK,EAG2B,OAF9BI,EAAMsC,UAAY,QAClBjB,EAAAc,GAASC,OAAOC,QAAQ,wCAGtBzC,GACFgB,EAAUhB,GAEZ0D,EAAIE,cAAcI,O,IAfpB9D,SAASuD,iBAAiB,UAkB1B,WAEE,IAAQQ,EAAuB7D,EAAM8D,kBAAkBC,wBAA/CC,OACRC,OAAOC,SAAS,CACdC,IAAgB,EAAXN,EACLO,SAAU,U","sources":["src/js/02-task.js"],"sourcesContent":["//import baguetteBox from 'baguettebox.js';\n\nimport '../css/styles.css';\nimport Notiflix from 'notiflix';\n//import disableScroll from 'disable-scroll';\nimport * as API from './fetchAPI';\nimport { makeMarkup } from './renderMarkup';\n\nconst PAGE_SET = 40;\nlet page;\nlet searchQuery = '';\nlet max;\nlet gallery;  \n\nconst form = document.querySelector('form');\nconst divEl = document.querySelector('.gallery');\nconst messageEl = document.querySelector('.message');\nconst targetEl = document.querySelector('.js-guard');\n\nconst options = {\n  root: null,\n  rootMargin: '600px',\n  threshold: 1.0,\n}\nconst observer = new IntersectionObserver(onLoad, options);\n\nform.addEventListener('submit', onSubmit);\ndocument.addEventListener('scroll', updateImg);\n\nfunction onSubmit (evt) {\n  evt.preventDefault();\n  searchQuery = evt.currentTarget.elements.searchQuery.value\n  console.log('searchQuery',searchQuery);\n  page = 1;\n  if (!searchQuery) {\n    divEl.innerHTML = '';\n    Notiflix.Notify.failure('Введіть будь ласка текст для пошуку!');   \n    return;\n  }  \n  if (searchQuery) {\n    fetchData(searchQuery);\n  } \n  evt.currentTarget.reset();\n}\n\nfunction updateImg() {\n //console.dir (divEl.firstElementChild.getBoundingClientRect())\n  const { height: cardHeight } = divEl.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight*2,\n    behavior: \"smooth\",\n  });\n}\n\n\nfunction onLoad (entries, observer){\n  entries.forEach(entry => {\n    console.log('entry.isIntersecting', entry.isIntersecting)\n    console.log('page', page)\n    if (!searchQuery) {\n      return;\n    }\n    if (entry.isIntersecting) {\n      page +=1;\n      fetchData(searchQuery);\n    } \n  });\n}\n\n\n\nasync function fetchData (res) {\n  try {\n    const data = await API.fetchAPI(res, page);\n    max = Math.ceil(data.totalHits/PAGE_SET);\n\n    console.log('data',data);\n    console.log('data.hits.length',data.hits.length);\n    \n    if (!data.hits.length) {\n      \n      Notiflix.Notify.failure('Sorry, there are no images matching your search query. Please try again.');\n      divEl.innerHTML = '';\n      messageEl.classList.add('visually-hidden');\n      return;\n    }\n    \n    if (page === 1) {\n      Notiflix.Notify.success(`Hooray! We found ${data.totalHits} images.`); \n      divEl.innerHTML = makeMarkup(data.hits);\n      gallery = new SimpleLightbox('.gallery a');\n      observer.observe(targetEl);\n      messageEl.classList.add('visually-hidden');\n    } else {\n      divEl.insertAdjacentHTML('beforeend', makeMarkup(data.hits));\n      gallery.refresh();\n    }\n\n    if (page === max) {\n      messageEl.classList.remove('visually-hidden');\n      observer.unobserve(targetEl);\n    }\n  } \n  \n  catch (error) {\n    console.log ('Oй помилочка: ', error.message);\n    Notiflix.Notify.failure('Упсс щось пішло не так... Спробуйте пізніше!');\n  }\n}\n\n\n\n  \n"],"names":["$6c6945dbdc778097$var$page","$6c6945dbdc778097$var$max","$6c6945dbdc778097$var$gallery","$bpxeT","parcelRequire","$6c6945dbdc778097$var$searchQuery","$6c6945dbdc778097$var$form","document","querySelector","$6c6945dbdc778097$var$divEl","$6c6945dbdc778097$var$messageEl","$6c6945dbdc778097$var$targetEl","$6c6945dbdc778097$var$observer","IntersectionObserver","entries","observer","forEach","entry","console","log","isIntersecting","$6c6945dbdc778097$var$fetchData","root","rootMargin","threshold","res","$6c6945dbdc778097$var$_fetchData","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","data","$lbRHt","fetchAPI","_ctx","sent","Math","ceil","totalHits","hits","length","$iU1Pc","Notify","failure","innerHTML","classList","add","success","concat","$5118m","makeMarkup","SimpleLightbox","observe","insertAdjacentHTML","refresh","remove","unobserve","t0","message","addEventListener","evt","preventDefault","currentTarget","elements","searchQuery","value","reset","cardHeight","firstElementChild","getBoundingClientRect","height","window","scrollBy","top","behavior"],"version":3,"file":"02-task.f9253e09.js.map"}